<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Checkout</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background-color: #FFFFFF;
    }
    .navbar {
      background-color: #000000 !important;
    }
    .navbar .nav-link {
      color: white !important;
      font-weight: bold;
    }
    .navbar .nav-link:hover {
      background-color: #333333;
      color: white !important;
      border-radius: 5px;
    }
    .section-title {
      color: #000000;
      margin-top: 20px;
      margin-bottom: 15px;
      border-bottom: 2px solid #000000;
      padding-bottom: 10px;
    }
    .btn-orange {
      background-color: #000000;
      border: none;
      color: white;
      font-weight: bold;
    }
    .btn-orange:hover {
      background-color: #333333;
      color: white;
    }
    .order-item {
      border-bottom: 1px solid #cccccc;
      padding: 10px 0;
    }
    .summary-box {
      background-color: #F5F5F5;
      padding: 20px;
      border-radius: 10px;
      border: 2px solid #000000;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-sm navbar-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Fresh Market</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="/cart">Back to Cart</a></li>
          <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <h2>Checkout</h2>

    <div class="row mt-4">
      <div class="col-md-8">
        <!-- Shipping Information -->
        <div>
          <h5 class="section-title">Shipping Information</h5>
          <form id="checkoutForm" method="POST" action="/checkout">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="firstName" class="form-label">First Name</label>
                <input type="text" class="form-control" id="firstName" name="firstName" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="lastName" class="form-label">Last Name</label>
                <input type="text" class="form-control" id="lastName" name="lastName" required>
              </div>
            </div>

            <div class="mb-3">
              <label for="email" class="form-label">Email</label>
              <input type="email" class="form-control" id="email" name="email" required>
            </div>

            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <input type="text" class="form-control" id="address" name="address" required>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="city" class="form-label">City</label>
                <input type="text" class="form-control" id="city" name="city" required>
              </div>
              <div class="col-md-6 mb-3">
                <label for="zipCode" class="form-label">ZIP Code</label>
                <input type="text" class="form-control" id="zipCode" name="zipCode" required>
              </div>
            </div>

            <!-- Payment Information -->
            <div>
              <h5 class="section-title">Payment Information</h5>
              <div class="mb-3">
                <label for="cardName" class="form-label">Cardholder Name</label>
                <input type="text" class="form-control" id="cardName" name="cardName" required>
              </div>

              <div class="mb-3">
                <label for="cardNumber" class="form-label">Card Number</label>
                <input type="text" class="form-control" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" required>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="expiryDate" class="form-label">Expiry Date</label>
                  <input type="text" class="form-control" id="expiryDate" name="expiryDate" placeholder="MM/YY" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="cvv" class="form-label">CVV</label>
                  <input type="text" class="form-control" id="cvv" name="cvv" placeholder="123" required>
                </div>
              </div>
            </div>

            <div class="d-flex gap-2 mt-4">
              <a href="/cart" class="btn btn-secondary">Back to Cart</a>
              <button type="submit" class="btn btn-orange">Place Order</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Order Summary Sidebar -->
      <div class="col-md-4">
        <div class="summary-box">
          <h5 class="section-title">Order Summary</h5>
          <% if (cart && cart.length > 0) { %>
            <% let subtotal = 0; %>
            <% cart.forEach(item => { %>
              <div class="order-item">
                <div class="d-flex justify-content-between">
                  <span><%= item.productName %></span>
                  <span>$<%= (item.price * item.quantity).toFixed(2) %></span>
                </div>
                <small class="text-muted">Qty: <%= item.quantity %></small>
              </div>
              <% subtotal += item.price * item.quantity; %>
            <% }) %>

            <div class="mt-3 pt-3" style="border-top: 2px solid #000000;">
              <div class="d-flex justify-content-between mb-2">
                <strong>Subtotal:</strong>
                <span>$<%= subtotal.toFixed(2) %></span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <strong>Tax (8%):</strong>
                <span>$<%= (subtotal * 0.08).toFixed(2) %></span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <strong>Shipping:</strong>
                <span><%= subtotal >= 100 ? 'FREE' : '$5.00' %></span>
              </div>
              <div class="d-flex justify-content-between mt-3 pt-3" style="border-top: 1px solid #000000; font-size: 1.2rem;">
                <strong>Total:</strong>
                <strong style="color: #000000;">
                  $<%= (subtotal * 1.08 + (subtotal >= 100 ? 0 : 5)).toFixed(2) %>
                </strong>
              </div>
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
